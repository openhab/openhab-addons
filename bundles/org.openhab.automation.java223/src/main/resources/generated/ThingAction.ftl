${AUTOGENERATED_WARNING}
package ${packageName};

import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import org.openhab.core.automation.module.script.defaultscope.ScriptThingActions;
import org.openhab.core.thing.binding.ThingActions;
import org.openhab.automation.java223.common.InjectBinding;
import org.openhab.automation.java223.common.Java223Exception;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
 
<#list classesToImport as classToImport>
<#if classToImport?has_content>
import ${classToImport};
</#if>
</#list>

@InjectBinding(disable = true)
public class ${simpleClassName} {

    protected static Logger logger = LoggerFactory.getLogger(${simpleClassName}.class);
    
    public static final String SCOPE = "${scope}";
    
    ThingActions thingActions;
    ScriptThingActions scriptThingActions;
    String thingUID;
    
    public ${simpleClassName}(ScriptThingActions actions, String thingUID) {
        this.thingActions = actions.get(SCOPE, thingUID);
        this.scriptThingActions = actions;
        this.thingUID = thingUID;
    }

<#list methods as method>
    /**
    * ${method.description()}<#list method.parameters() as parameter>
    * @param ${parameter.name()} ${parameter.description()}</#list><#if (method.returnValueType() != "void")>
    * @return <#list method.outputs() as output> ${output.name} - ${output.description}<#sep> # </#list></#if>
    */<#if (method.returnValueType() != "void") && method.returnValueType()?contains("<")>
    @SuppressWarnings("unchecked")</#if>
    public ${method.returnValueType()} ${method.name()}(<#list method.parameters() as parameter>${parameter.type()} ${parameter.name()}<#sep>, </#list>) {
        if (thingActions == null) {
            thingActions = scriptThingActions.get(SCOPE, thingUID);
            if (thingActions == null) {
                throw new Java223Exception("Action is null. Thing " + thingUID + " may be of the wrong type, or not initialized ?");
            }
        }

        try {
            Class<?> thingActionClass = thingActions.getClass();
<#if (method.parameters()?size > 0)>
            Method method = thingActionClass.getMethod("${method.name()}", <#list method.parameters() as parameter>${parameter.nonGenericType()}.class<#sep>, </#list>);
            <#if (method.returnValueType() != "void")>Object returnValue = </#if>method.invoke(thingActions, <#list method.parameters() as parameter>${parameter.name()}<#sep>, </#list>);
<#else>
            Method method = thingActionClass.getMethod("${method.name()}");
            <#if (method.returnValueType() != "void")>Object returnValue = </#if>method.invoke(thingActions);
</#if>
<#if (method.returnValueType() != "void")>
            return (${method.returnValueType()}) returnValue;
</#if>            
        } catch (NoSuchMethodException | SecurityException | IllegalAccessException
                | IllegalArgumentException | InvocationTargetException e) {
            throw new Java223Exception("Error running action ${method.name()}", e);
        }
    }

</#list>
}